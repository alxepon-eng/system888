<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f0f7ff;
        }
        
        .tab-active {
            background-color: #e0edff;
            border-bottom: 3px solid #3b82f6;
            color: #1e40af;
            font-weight: 600;
        }
        
        .form-input {
            border: 1px solid #cce3ff;
            background-color: #ffffff;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            border-color: #93c5fd;
            box-shadow: 0 0 0 3px rgba(147, 197, 253, 0.3);
        }
        
        .btn-primary {
            background-color: #3b82f6;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-checked {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-resubmit {
            background-color: #fee2e2;
            color: #b91c1c;
        }
        
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
</head>
<body>
    <div class="min-h-screen bg-gradient-to-b from-blue-50 to-blue-100">
        <header class="bg-white shadow-sm">
            <div class="container mx-auto px-4 py-6">
                <h1 class="text-3xl font-bold text-blue-800 text-center">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h1>
                <p class="text-center text-blue-600 mt-1">Online Student Assignment Submission System (‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£)</p>
            </div>
        </header>
        
        <main class="container mx-auto px-4 py-8">
            <div class="flex border-b border-blue-200 mb-6">
                <button id="tab-submit" class="tab-active px-6 py-3 text-lg flex-1 text-center">üìù ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</button>
                <button id="tab-students" class="px-6 py-3 text-lg flex-1 text-center text-blue-700">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                <button id="tab-status" class="px-6 py-3 text-lg flex-1 text-center text-blue-700">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</button>
            </div>
            
            <div id="content-submit" class="card p-6">
                <form id="submission-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="name" class="block text-blue-800 font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" id="name" name="name" required class="form-input w-full px-4 py-2 rounded-lg" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                        </div>
                        <div>
                            <label for="number" class="block text-blue-800 font-medium mb-2">‡∏•‡∏≥‡∏î‡∏±‡∏ö/‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
                            <input type="number" id="number" name="number" required class="form-input w-full px-4 py-2 rounded-lg" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
                        </div>
                    </div>
                    
                    <div>
                        <label for="title" class="block text-blue-800 font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô</label>
                        <input type="text" id="title" name="title" required class="form-input w-full px-4 py-2 rounded-lg" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô">
                    </div>
                    
                    <div>
                        <label for="description" class="block text-blue-800 font-medium mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏±‡πâ‡∏ô ‡πÜ</label>
                        <textarea id="description" name="description" rows="3" class="form-input w-full px-4 py-2 rounded-lg" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô"></textarea>
                    </div>
                    
                    <div>
                        <label for="link" class="block text-blue-800 font-medium mb-2">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô</label>
                        <input type="url" id="link" name="link" class="form-input w-full px-4 py-2 rounded-lg" placeholder="https://...">
                    </div>
                    
                    <div>
                        <label for="note" class="block text-blue-800 font-medium mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                        <textarea id="note" name="note" rows="2" class="form-input w-full px-4 py-2 rounded-lg" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"></textarea>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn-primary text-white px-8 py-3 rounded-lg font-medium text-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </div>
                </form>
            </div>
            
            <div id="content-students" class="card p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-blue-800">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                    <button id="fetch-students" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="students-grid">
                    </div>
                
                <div id="no-students" class="text-center py-8 text-gray-500">
                    ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </div>
            </div>
            
            <div id="content-status" class="card p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-blue-800">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                    <button id="fetch-status" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-yellow-600" id="pending-count">0</div>
                        <div class="text-yellow-700">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</div>
                    </div>
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-green-600" id="checked-count">0</div>
                        <div class="text-green-700">‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß</div>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-red-600" id="resubmit-count">0</div>
                        <div class="text-red-700">‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà</div>
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-blue-600" id="total-count">0</div>
                        <div class="text-blue-700">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead class="bg-blue-100 text-blue-800">
                            <tr>
                                <th class="px-4 py-3 text-left">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-3 text-left">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-3 text-left">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô</th>
                                <th class="px-4 py-3 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
                                <th class="px-4 py-3 text-left">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-3 text-left">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="status-list">
                            </tbody>
                    </table>
                </div>
                
                <div id="no-status" class="text-center py-8 text-gray-500">
                    ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </div>
            </div>
            
            <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                <div class="bg-white rounded-lg w-full max-w-2xl mx-4 overflow-hidden">
                    <div class="bg-blue-50 px-6 py-4 border-b border-blue-100 flex justify-between items-center">
                        <h3 class="text-xl font-semibold text-blue-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</h3>
                        <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                    <div class="p-6 space-y-4" id="detail-content">
                        </div>
                    <div class="bg-gray-50 px-6 py-4 border-t border-gray-100 text-right">
                        <button id="close-detail" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">‡∏õ‡∏¥‡∏î</button>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="bg-blue-800 text-white py-4 mt-8">
            <div class="container mx-auto px-4 text-center">
                <p>¬© 2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
            </div>
        </footer>
    </div>

    <script>
        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô - ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 1
        let submissions = JSON.parse(localStorage.getItem('submissions')) || [];
        
        // ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 1 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
        const OFFLINE_MODE = true;
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ó‡πá‡∏ö
        function switchTab(activeTab) {
            // ‡∏•‡∏ö active class ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÅ‡∏ó‡πá‡∏ö
            document.querySelectorAll('[id^="tab-"]').forEach(tab => {
                tab.classList.remove('tab-active');
                tab.classList.add('text-blue-700');
            });
            
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å content
            document.querySelectorAll('[id^="content-"]').forEach(content => {
                content.classList.add('hidden');
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ó‡πá‡∏ö‡πÅ‡∏•‡∏∞ content ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            document.getElementById(`tab-${activeTab}`).classList.add('tab-active');
            document.getElementById(`tab-${activeTab}`).classList.remove('text-blue-700');
            document.getElementById(`content-${activeTab}`).classList.remove('hidden');
        }
        
        document.getElementById('tab-submit').addEventListener('click', function() {
            switchTab('submit');
        });
        
        document.getElementById('tab-students').addEventListener('click', function() {
            switchTab('students');
            renderStudents();
        });
        
        document.getElementById('tab-status').addEventListener('click', function() {
            switchTab('status');
            renderStatusTable();
            updateStatusCounts();
        });
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£
        document.getElementById('submission-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // ‡πÅ‡∏™‡∏î‡∏á loading
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: '<div class="text-blue-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets</div>',
                allowOutsideClick: false,
                showConfirmButton: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });
            
            const formData = new FormData(this);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets
            const submissionData = {
                id: Date.now(),
                name: formData.get('name'),
                number: formData.get('number'),
                title: formData.get('title'),
                description: formData.get('description'),
                link: formData.get('link'),
                note: formData.get('note'),
                date: new Date().toISOString(),
                status: '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à'
            };
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage ‡∏Å‡πà‡∏≠‡∏ô (‡πÄ‡∏õ‡πá‡∏ô backup)
            submissions.push(submissionData);
            localStorage.setItem('submissions', JSON.stringify(submissions));
            
            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡∏ú‡πà‡∏≤‡∏ô JSONP
            sendToGoogleSheets(submissionData);
        });
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡∏ú‡πà‡∏≤‡∏ô JSONP
        function sendToGoogleSheets(data) {
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyM-5RGsr0n9O5RrfRuqdvXrqh8bmbCyUN6o-mxaLfy5ZeoCxGUreaf_ofaxu-GNMSb-A/exec';
            const DRIVE_FOLDER_ID = '1uH-ImHslwgFyvOitHxdxv4G0BA1zIKlD';
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á callback function
            const callbackName = 'jsonpCallback_' + Date.now();
            const timeoutId = setTimeout(() => {
                // Timeout ‡∏´‡∏•‡∏±‡∏á 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                if (window[callbackName]) {
                    delete window[callbackName];
                    if (document.body.contains(script)) {
                        document.body.removeChild(script);
                    }
                    Swal.fire({
                        icon: 'warning',
                        title: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ä‡πâ‡∏≤',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á Google Sheets',
                        confirmButtonColor: '#3b82f6'
                    }).then(() => {
                        document.getElementById('submission-form').reset();
                    });
                }
            }, 15000);
            
            window[callbackName] = function(response) {
                clearTimeout(timeoutId);
                
                // ‡∏•‡∏ö script element ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
                if (document.body.contains(script)) {
                    document.body.removeChild(script);
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                if (response && response.result === 'success') {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        html: '<div class="text-green-600">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Sheets ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div>',
                        confirmButtonColor: '#3b82f6',
                        timer: 3000,
                        timerProgressBar: true
                    }).then(() => {
                        document.getElementById('submission-form').reset();
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                        text: response?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                        confirmButtonColor: '#3b82f6'
                    });
                }
                
                // ‡∏•‡∏ö callback function
                delete window[callbackName];
            };
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° Drive Folder ID ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const dataWithDrive = {
                ...data,
                driveFolderId: DRIVE_FOLDER_ID
            };
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
            const jsonData = JSON.stringify(dataWithDrive);
            const url = `${SCRIPT_URL}?callback=${callbackName}&action=submit&data=${encodeURIComponent(jsonData)}`;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á script element ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô DOM
            const script = document.createElement('script');
            script.src = url;
            script.onerror = function() {
                clearTimeout(timeoutId);
                delete window[callbackName];
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
                    text: '‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï',
                    confirmButtonColor: '#3b82f6'
                });
            };
            document.body.appendChild(script);
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        function renderStudents() {
            const studentsGrid = document.getElementById('students-grid');
            const noStudents = document.getElementById('no-students');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
            const uniqueStudents = [];
            const studentMap = new Map();
            
            submissions.forEach(submission => {
                if (!studentMap.has(submission.number)) {
                    studentMap.set(submission.number, {
                        number: submission.number,
                        name: submission.name,
                        totalSubmissions: 1,
                        lastSubmission: submission.date,
                        lastStatus: submission.status
                    });
                } else {
                    const student = studentMap.get(submission.number);
                    student.totalSubmissions++;
                    if (new Date(submission.date) > new Date(student.lastSubmission)) {
                        student.lastSubmission = submission.date;
                        student.lastStatus = submission.status;
                    }
                }
            });
            
            uniqueStudents.push(...studentMap.values());
            
            if (uniqueStudents.length === 0) {
                studentsGrid.innerHTML = '';
                noStudents.classList.remove('hidden');
                return;
            }
            
            noStudents.classList.add('hidden');
            studentsGrid.innerHTML = '';
            
            uniqueStudents.sort((a, b) => a.number - b.number).forEach(student => {
                const lastDate = new Date(student.lastSubmission);
                const formattedDate = `${lastDate.toLocaleDateString('th-TH')}`;
                
                let statusClass = '';
                switch (student.lastStatus) {
                    case '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à':
                        statusClass = 'status-pending';
                        break;
                    case '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß':
                        statusClass = 'status-checked';
                        break;
                    case '‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà':
                        statusClass = 'status-resubmit';
                        break;
                }
                
                const studentCard = document.createElement('div');
                studentCard.className = 'bg-white border border-blue-200 rounded-lg p-4 hover:shadow-md transition-shadow';
                studentCard.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <div class="text-lg font-semibold text-blue-800">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${student.number}</div>
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${statusClass}">
                            ${student.lastStatus}
                        </span>
                    </div>
                    <div class="text-gray-700 mb-2">${student.name}</div>
                    <div class="text-sm text-gray-500 mb-2">‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${student.totalSubmissions} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                    <div class="text-sm text-gray-500 mb-3">‡∏™‡πà‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${formattedDate}</div>
                    <button class="view-student-history w-full bg-blue-100 hover:bg-blue-200 text-blue-800 px-3 py-2 rounded-lg text-sm font-medium" data-number="${student.number}">
                        ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô
                    </button>
                `;
                
                studentsGrid.appendChild(studentCard);
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            document.querySelectorAll('.view-student-history').forEach(button => {
                button.addEventListener('click', function() {
                    const studentNumber = this.getAttribute('data-number');
                    showStudentHistory(studentNumber);
                });
            });
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô
        function renderStatusTable() {
            const statusList = document.getElementById('status-list');
            const noStatus = document.getElementById('no-status');
            
            if (submissions.length === 0) {
                statusList.innerHTML = '';
                noStatus.classList.remove('hidden');
                return;
            }
            
            noStatus.classList.add('hidden');
            statusList.innerHTML = '';
            
            submissions.forEach((submission, index) => {
                const row = document.createElement('tr');
                row.className = index % 2 === 0 ? 'bg-blue-50' : 'bg-white';
                
                const date = new Date(submission.date);
                const formattedDate = `${date.toLocaleDateString('th-TH')} ${date.toLocaleTimeString('th-TH')}`;
                
                let statusClass = '';
                switch (submission.status) {
                    case '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à':
                        statusClass = 'status-pending';
                        break;
                    case '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß':
                        statusClass = 'status-checked';
                        break;
                    case '‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà':
                        statusClass = 'status-resubmit';
                        break;
                }
                
                row.innerHTML = `
                    <td class="px-4 py-3 border-b border-blue-100">${submission.number}</td>
                    <td class="px-4 py-3 border-b border-blue-100">${submission.name}</td>
                    <td class="px-4 py-3 border-b border-blue-100">${submission.title}</td>
                    <td class="px-4 py-3 border-b border-blue-100">${formattedDate}</td>
                    <td class="px-4 py-3 border-b border-blue-100">
                        <span class="px-2 py-1 rounded-full text-xs font-medium ${statusClass}">
                            ${submission.status}
                        </span>
                    </td>
                    <td class="px-4 py-3 border-b border-blue-100">
                        <button class="view-detail bg-blue-100 hover:bg-blue-200 text-blue-800 px-3 py-1 rounded-lg text-sm" data-index="${index}">
                            ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                        </button>
                    </td>
                `;
                
                statusList.appendChild(row);
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
            document.querySelectorAll('.view-detail').forEach(button => {
                button.addEventListener('click', function() {
                    const index = this.getAttribute('data-index');
                    showDetailModal(submissions[index]);
                });
            });
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function updateStatusCounts() {
            const pendingCount = submissions.filter(s => s.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à').length;
            const checkedCount = submissions.filter(s => s.status === '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß').length;
            const resubmitCount = submissions.filter(s => s.status === '‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà').length;
            const totalCount = submissions.length;
            
            document.getElementById('pending-count').textContent = pendingCount;
            document.getElementById('checked-count').textContent = checkedCount;
            document.getElementById('resubmit-count').textContent = resubmitCount;
            document.getElementById('total-count').textContent = totalCount;
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        function showStudentHistory(studentNumber) {
            const studentSubmissions = submissions.filter(s => s.number == studentNumber);
            const studentName = studentSubmissions[0]?.name || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            
            let historyHtml = `
                <div class="mb-4">
                    <h3 class="text-lg font-semibold text-blue-800">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô - ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${studentNumber}</h3>
                    <p class="text-gray-600">${studentName}</p>
                </div>
                <div class="space-y-3">
            `;
            
            studentSubmissions.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach((submission, index) => {
                const date = new Date(submission.date);
                const formattedDate = `${date.toLocaleDateString('th-TH')} ${date.toLocaleTimeString('th-TH')}`;
                
                let statusClass = '';
                switch (submission.status) {
                    case '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à':
                        statusClass = 'status-pending';
                        break;
                    case '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß':
                        statusClass = 'status-checked';
                        break;
                    case '‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà':
                        statusClass = 'status-resubmit';
                        break;
                }
                
                historyHtml += `
                    <div class="border border-gray-200 rounded-lg p-4 ${index === 0 ? 'bg-blue-50' : 'bg-white'}">
                        <div class="flex justify-between items-start mb-2">
                            <div class="font-medium text-blue-800">${submission.title}</div>
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${statusClass}">
                                ${submission.status}
                            </span>
                        </div>
                        <div class="text-sm text-gray-600 mb-2">${submission.description || '-'}</div>
                        <div class="text-xs text-gray-500">${formattedDate}</div>
                        ${submission.link ? `<div class="text-xs mt-1"><a href="${submission.link}" target="_blank" class="text-blue-600 hover:underline">‡∏î‡∏π‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô</a></div>` : ''}
                    </div>
                `;
            });
            
            historyHtml += '</div>';
            
            document.getElementById('detail-content').innerHTML = historyHtml;
            document.getElementById('detail-modal').classList.remove('hidden');
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á modal ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô
        function showDetailModal(submission) {
            const detailContent = document.getElementById('detail-content');
            const date = new Date(submission.date);
            const formattedDate = `${date.toLocaleDateString('th-TH')} ${date.toLocaleTimeString('th-TH')}`;
            
            let linkDisplay = '';
            if (submission.link) {
                linkDisplay = `
                    <div class="mt-2">
                        <p class="font-medium">‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô:</p>
                        <a href="${submission.link}" target="_blank" class="text-blue-600 hover:underline break-all">${submission.link}</a>
                    </div>
                `;
            }
            
            let statusClass = '';
            switch (submission.status) {
                case '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à':
                    statusClass = 'status-pending';
                    break;
                case '‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß':
                    statusClass = 'status-checked';
                    break;
                case '‡∏™‡πà‡∏á‡πÉ‡∏´‡∏°‡πà':
                    statusClass = 'status-resubmit';
                    break;
            }
            
            detailContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="text-gray-600">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</p>
                        <p class="font-medium">${submission.name}</p>
                    </div>
                    <div>
                        <p class="text-gray-600">‡∏•‡∏≥‡∏î‡∏±‡∏ö/‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</p>
                        <p class="font-medium">${submission.number}</p>
                    </div>
                </div>
                
                <div class="mt-4">
                    <p class="text-gray-600">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏≤‡∏ô:</p>
                    <p class="font-medium">${submission.title}</p>
                </div>
                
                <div class="mt-4">
                    <p class="text-gray-600">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</p>
                    <p>${submission.description || '-'}</p>
                </div>
                
                ${linkDisplay}
                
                <div class="mt-4">
                    <p class="text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á:</p>
                    <p>${formattedDate}</p>
                </div>
                
                <div class="mt-4">
                    <p class="text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</p>
                    <span class="px-3 py-1 rounded-full text-sm font-medium ${statusClass}">
                        ${submission.status}
                    </span>
                </div>
                
                <div class="mt-4">
                    <p class="text-gray-600">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</p>
                    <p>${submission.note || '-'}</p>
                </div>
            `;
            
            document.getElementById('detail-modal').classList.remove('hidden');
        }
        
        // ‡∏õ‡∏¥‡∏î modal
        document.getElementById('close-modal').addEventListener('click', function() {
            document.getElementById('detail-modal').classList.add('hidden');
        });
        
        document.getElementById('close-detail').addEventListener('click', function() {
            document.getElementById('detail-modal').classList.add('hidden');
        });
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        document.getElementById('fetch-students').addEventListener('click', function() {
            fetchDataFromGoogleSheets('students');
        });
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô
        document.getElementById('fetch-status').addEventListener('click', function() {
            fetchDataFromGoogleSheets('status');
        });
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
        function fetchDataFromGoogleSheets(type) {
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyM-5RGsr0n9O5RrfRuqdvXrqh8bmbCyUN6o-mxaLfy5ZeoCxGUreaf_ofaxu-GNMSb-A/exec';
            
            // ‡πÅ‡∏™‡∏î‡∏á loading
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: '<div class="text-blue-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets</div>',
                allowOutsideClick: false,
                showConfirmButton: false,
                didOpen: () => {
                    Swal.showLoading();
                }
            });
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á callback function
            const callbackName = 'jsonpCallback_' + Date.now();
            const timeoutId = setTimeout(() => {
                // Timeout ‡∏´‡∏•‡∏±‡∏á 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                if (window[callbackName]) {
                    delete window[callbackName];
                    if (document.body.contains(script)) {
                        document.body.removeChild(script);
                    }
                    Swal.fire({
                        icon: 'warning',
                        title: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ä‡πâ‡∏≤',
                        text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÑ‡∏î‡πâ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ',
                        confirmButtonColor: '#3b82f6',
                        timer: 3000
                    });
                    
                    // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ó‡∏ô
                    if (type === 'students') {
                        renderStudents();
                    } else if (type === 'status') {
                        renderStatusTable();
                        updateStatusCounts();
                    }
                }
            }, 10000);
            
            window[callbackName] = function(response) {
                clearTimeout(timeoutId);
                
                // ‡∏•‡∏ö script element ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
                if (document.body.contains(script)) {
                    document.body.removeChild(script);
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                if (response && response.result === 'success' && response.data) {
                    submissions = response.data;
                    localStorage.setItem('submissions', JSON.stringify(submissions));
                    
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                    if (type === 'students') {
                        renderStudents();
                    } else if (type === 'status') {
                        renderStatusTable();
                        updateStatusCounts();
                    }
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                        html: `<div class="text-green-600">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${submissions.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`,
                        confirmButtonColor: '#3b82f6',
                        timer: 2000,
                        timerProgressBar: true
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                        text: response?.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                        confirmButtonColor: '#3b82f6'
                    });
                }
                
                // ‡∏•‡∏ö callback function
                delete window[callbackName];
            };
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
            const url = `${SCRIPT_URL}?callback=${callbackName}&action=fetch&t=${Date.now()}`;
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á script element ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô DOM
            const script = document.createElement('script');
            script.src = url;
            script.onerror = function() {
                clearTimeout(timeoutId);
                delete window[callbackName];
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
                    text: '‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï',
                    confirmButtonColor: '#3b82f6'
                });
            };
            document.body.appendChild(script);
        }
        
        // ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 1: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        updateStatusCounts();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979642cd039487e6',t:'MTc1NjkxMzEzOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>